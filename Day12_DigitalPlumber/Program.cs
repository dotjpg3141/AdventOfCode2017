using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading.Tasks;

namespace Day12_DigitalPlumber
{
	class Program
	{
		private static readonly Regex NewLine = new Regex("\r?\n");
		private static readonly Regex Arrow = new Regex("<->");
		private static readonly Regex Seperator = new Regex(",");

		static void Main(string[] args)
		{
			var example = "0 <-> 2\n1 <-> 1\n2 <-> 0, 3, 4\n3 <-> 2, 4\n4 <-> 2, 3, 6\n5 <-> 6\n6 <-> 4, 5";
			var input = "0 <-> 780, 1330\n1 <-> 264, 595, 1439\n2 <-> 296, 531, 1440\n3 <-> 207, 235, 1038\n4 <-> 554, 1295\n5 <-> 159, 568, 1381\n6 <-> 1134\n7 <-> 1472, 1977\n8 <-> 704\n9 <-> 783, 1082, 1795\n10 <-> 46, 653, 958\n11 <-> 55, 1931\n12 <-> 12\n13 <-> 537, 940\n14 <-> 1066, 1411, 1997\n15 <-> 1528\n16 <-> 27\n17 <-> 113, 370, 450, 982\n18 <-> 571\n19 <-> 1606\n20 <-> 803\n21 <-> 956\n22 <-> 181, 1126, 1431, 1737\n23 <-> 131, 162, 967, 1973\n24 <-> 526, 1914\n25 <-> 551, 1057\n26 <-> 1162, 1922\n27 <-> 16, 533, 1125\n28 <-> 468, 902, 1159\n29 <-> 29\n30 <-> 749, 1079, 1684\n31 <-> 1909, 1992\n32 <-> 1666\n33 <-> 426, 1662, 1883\n34 <-> 109\n35 <-> 307, 577, 727, 1763, 1948\n36 <-> 578\n37 <-> 92, 503, 1203, 1255\n38 <-> 38, 471\n39 <-> 615\n40 <-> 584, 1787\n41 <-> 591, 756\n42 <-> 888\n43 <-> 952\n44 <-> 1029\n45 <-> 45, 300, 596, 1393, 1486\n46 <-> 10, 1887\n47 <-> 592\n48 <-> 108\n49 <-> 1583\n50 <-> 1200\n51 <-> 51, 857\n52 <-> 965\n53 <-> 702, 1428\n54 <-> 1525\n55 <-> 11, 610\n56 <-> 1703\n57 <-> 1449\n58 <-> 1097\n59 <-> 1316, 1461, 1932\n60 <-> 107, 1010, 1504, 1824, 1912\n61 <-> 1677\n62 <-> 691, 714, 1530\n63 <-> 672, 1263, 1956\n64 <-> 825, 1016, 1370\n65 <-> 539, 1055, 1290\n66 <-> 1287\n67 <-> 338, 1195\n68 <-> 108, 296, 1787, 1821\n69 <-> 436, 1015, 1633\n70 <-> 262, 407, 592, 1414\n71 <-> 420, 797\n72 <-> 1393\n73 <-> 616, 993\n74 <-> 168, 175\n75 <-> 590, 1103\n76 <-> 271\n77 <-> 1309, 1496, 1627\n78 <-> 569, 1888\n79 <-> 1289, 1925\n80 <-> 193, 993\n81 <-> 500\n82 <-> 1069\n83 <-> 83, 1518\n84 <-> 1465\n85 <-> 1614\n86 <-> 474, 749, 1286, 1678\n87 <-> 160\n88 <-> 1026, 1732\n89 <-> 317, 422, 917\n90 <-> 517, 1362\n91 <-> 136\n92 <-> 37, 703\n93 <-> 1738, 1827\n94 <-> 345, 907, 1180\n95 <-> 95\n96 <-> 406, 1086, 1258\n97 <-> 97, 157\n98 <-> 1002\n99 <-> 109, 198, 654\n100 <-> 555\n101 <-> 101\n102 <-> 939\n103 <-> 616, 1266\n104 <-> 1526\n105 <-> 306, 1276, 1330\n106 <-> 1395\n107 <-> 60, 288, 1971\n108 <-> 48, 68\n109 <-> 34, 99, 578, 1042\n110 <-> 906, 1567\n111 <-> 917, 1347\n112 <-> 1291, 1384, 1695, 1988\n113 <-> 17, 1173\n114 <-> 297, 1576\n115 <-> 361\n116 <-> 117, 1084\n117 <-> 116, 164, 683, 1454\n118 <-> 1956\n119 <-> 1198\n120 <-> 171, 416\n121 <-> 1949\n122 <-> 233, 770, 1012\n123 <-> 801\n124 <-> 1406\n125 <-> 769\n126 <-> 418, 1038, 1273\n127 <-> 611, 1060, 1241\n128 <-> 576, 665, 1568\n129 <-> 862\n130 <-> 1607, 1644\n131 <-> 23, 812\n132 <-> 1097\n133 <-> 1403, 1992\n134 <-> 232\n135 <-> 959\n136 <-> 91, 1354, 1868, 1932\n137 <-> 766, 1049\n138 <-> 138\n139 <-> 139, 355\n140 <-> 1858\n141 <-> 703, 1319\n142 <-> 424\n143 <-> 869\n144 <-> 231, 338\n145 <-> 1163, 1345\n146 <-> 431, 940, 1389\n147 <-> 1282, 1784\n148 <-> 218, 1137\n149 <-> 378\n150 <-> 257, 798\n151 <-> 1603\n152 <-> 152, 189, 1151\n153 <-> 623, 1228\n154 <-> 154\n155 <-> 376, 808\n156 <-> 1726\n157 <-> 97\n158 <-> 482\n159 <-> 5\n160 <-> 87, 504, 1775\n161 <-> 873, 1047\n162 <-> 23\n163 <-> 291\n164 <-> 117, 229, 371, 1427\n165 <-> 487, 1683, 1844\n166 <-> 508\n167 <-> 278, 1228, 1453\n168 <-> 74, 1210\n169 <-> 396, 410, 1256\n170 <-> 555, 1624\n171 <-> 120, 340, 1713\n172 <-> 1748\n173 <-> 880, 1306\n174 <-> 1052, 1697\n175 <-> 74, 995\n176 <-> 1421\n177 <-> 551, 640\n178 <-> 1611\n179 <-> 1504\n180 <-> 310, 1432, 1722\n181 <-> 22\n182 <-> 1175\n183 <-> 1115\n184 <-> 184\n185 <-> 708\n186 <-> 1130\n187 <-> 944\n188 <-> 451, 593\n189 <-> 152\n190 <-> 885, 1491\n191 <-> 191\n192 <-> 1751\n193 <-> 80, 931\n194 <-> 544, 826\n195 <-> 1354\n196 <-> 705\n197 <-> 1646, 1693\n198 <-> 99\n199 <-> 1681, 1818\n200 <-> 200\n201 <-> 678, 691\n202 <-> 1084\n203 <-> 446, 1232\n204 <-> 337, 826, 1919\n205 <-> 440, 818\n206 <-> 618, 898\n207 <-> 3\n208 <-> 208\n209 <-> 574, 1760, 1774\n210 <-> 960, 1315\n211 <-> 525, 670\n212 <-> 453, 1552\n213 <-> 1164\n214 <-> 893, 1597\n215 <-> 386, 1412, 1752\n216 <-> 1800\n217 <-> 1103\n218 <-> 148, 218\n219 <-> 1135, 1216, 1404\n220 <-> 1899\n221 <-> 987, 1248\n222 <-> 706, 1199, 1916\n223 <-> 816, 1079, 1703\n224 <-> 726\n225 <-> 797\n226 <-> 396, 1482\n227 <-> 844\n228 <-> 703, 972, 1275\n229 <-> 164, 377, 662, 1048\n230 <-> 230, 661\n231 <-> 144, 1358\n232 <-> 134, 793, 1433, 1730\n233 <-> 122\n234 <-> 882\n235 <-> 3, 489\n236 <-> 945, 1346\n237 <-> 480\n238 <-> 702\n239 <-> 1008\n240 <-> 1078\n241 <-> 1103, 1844\n242 <-> 666, 1299\n243 <-> 1489\n244 <-> 423, 827, 860, 868\n245 <-> 1747\n246 <-> 659, 1446\n247 <-> 679\n248 <-> 1467, 1942\n249 <-> 1678\n250 <-> 284, 1223\n251 <-> 1513\n252 <-> 1673\n253 <-> 1084\n254 <-> 747, 1705\n255 <-> 255\n256 <-> 390\n257 <-> 150, 1439, 1804\n258 <-> 1302, 1626\n259 <-> 259, 1519\n260 <-> 449\n261 <-> 269, 641\n262 <-> 70\n263 <-> 1334, 1358\n264 <-> 1, 1843\n265 <-> 1316\n266 <-> 1045, 1053, 1264\n267 <-> 364, 1198\n268 <-> 501, 594, 732, 1919\n269 <-> 261, 681\n270 <-> 670, 1283, 1531\n271 <-> 76, 1817, 1858\n272 <-> 625, 757, 1236, 1793\n273 <-> 1255, 1539\n274 <-> 442, 1406\n275 <-> 706, 1760\n276 <-> 841, 1553, 1764\n277 <-> 1133\n278 <-> 167, 908\n279 <-> 1771\n280 <-> 280, 1583\n281 <-> 702\n282 <-> 282, 1712, 1776\n283 <-> 820, 981\n284 <-> 250\n285 <-> 680, 880, 1896\n286 <-> 286, 489\n287 <-> 608, 1204, 1423\n288 <-> 107, 1353, 1729\n289 <-> 289, 299\n290 <-> 761, 1134\n291 <-> 163, 801, 1435\n292 <-> 1217, 1525\n293 <-> 1206\n294 <-> 797, 1124, 1371\n295 <-> 335, 704\n296 <-> 2, 68, 1516\n297 <-> 114, 1036, 1987\n298 <-> 298, 588, 1430\n299 <-> 289\n300 <-> 45, 1965\n301 <-> 773, 1591\n302 <-> 1122, 1341\n303 <-> 450, 1786\n304 <-> 304\n305 <-> 724\n306 <-> 105, 1861\n307 <-> 35\n308 <-> 308, 1015\n309 <-> 930, 1011\n310 <-> 180\n311 <-> 1513\n312 <-> 646\n313 <-> 1381\n314 <-> 511, 804, 1079\n315 <-> 399\n316 <-> 948, 1169\n317 <-> 89, 725\n318 <-> 318\n319 <-> 319\n320 <-> 787\n321 <-> 1132\n322 <-> 322\n323 <-> 1376\n324 <-> 1540\n325 <-> 1448, 1944, 1995\n326 <-> 1828\n327 <-> 1886\n328 <-> 639\n329 <-> 831, 959\n330 <-> 527\n331 <-> 1399, 1535\n332 <-> 1843\n333 <-> 333, 522\n334 <-> 1512\n335 <-> 295, 885\n336 <-> 1651\n337 <-> 204, 1164, 1874\n338 <-> 67, 144, 584, 621\n339 <-> 1887\n340 <-> 171, 1861\n341 <-> 1555\n342 <-> 507\n343 <-> 1441\n344 <-> 409, 527, 1364, 1756\n345 <-> 94\n346 <-> 357, 499\n347 <-> 795, 1065, 1191\n348 <-> 914, 1800, 1982\n349 <-> 349\n350 <-> 436\n351 <-> 1472, 1514\n352 <-> 375, 884\n353 <-> 499, 567\n354 <-> 1033, 1218\n355 <-> 139\n356 <-> 866\n357 <-> 346, 1665\n358 <-> 1225\n359 <-> 359, 1429\n360 <-> 1512\n361 <-> 115, 920, 1975\n362 <-> 507, 682, 1116, 1762\n363 <-> 1583, 1737\n364 <-> 267\n365 <-> 1878, 1885\n366 <-> 1060\n367 <-> 421\n368 <-> 1362\n369 <-> 532, 1140\n370 <-> 17, 1065, 1117\n371 <-> 164\n372 <-> 372\n373 <-> 373\n374 <-> 1050\n375 <-> 352, 1311, 1446\n376 <-> 155, 1928\n377 <-> 229, 636\n378 <-> 149, 1897\n379 <-> 936\n380 <-> 1193, 1963\n381 <-> 1783\n382 <-> 1900\n383 <-> 383\n384 <-> 1630\n385 <-> 441\n386 <-> 215\n387 <-> 795, 946\n388 <-> 1457\n389 <-> 731, 1973\n390 <-> 256, 1706, 1900\n391 <-> 391\n392 <-> 1400\n393 <-> 818, 1244\n394 <-> 394, 1881\n395 <-> 395, 1656\n396 <-> 169, 226\n397 <-> 1790\n398 <-> 1260\n399 <-> 315, 399\n400 <-> 1204\n401 <-> 1606\n402 <-> 1191, 1726, 1853\n403 <-> 403\n404 <-> 1470\n405 <-> 1924\n406 <-> 96, 413, 1201\n407 <-> 70\n408 <-> 1063, 1216, 1586\n409 <-> 344, 409, 1625, 1803\n410 <-> 169, 1732\n411 <-> 1599\n412 <-> 889, 1460\n413 <-> 406, 761, 1918\n414 <-> 661\n415 <-> 442, 962, 1200\n416 <-> 120, 503\n417 <-> 446, 612, 1007\n418 <-> 126, 797, 1478, 1857\n419 <-> 1060, 1350, 1459, 1736\n420 <-> 71, 978, 1215\n421 <-> 367, 665, 1385, 1415\n422 <-> 89, 679, 1418\n423 <-> 244\n424 <-> 142, 1813\n425 <-> 627, 981\n426 <-> 33\n427 <-> 1172, 1495, 1740\n428 <-> 1869\n429 <-> 966, 986, 1162, 1658\n430 <-> 1866\n431 <-> 146, 1523, 1934\n432 <-> 558, 811, 944\n433 <-> 693, 1291\n434 <-> 766\n435 <-> 1784\n436 <-> 69, 350, 1064\n437 <-> 766, 817, 882, 1481\n438 <-> 742, 1159\n439 <-> 724, 1518\n440 <-> 205\n441 <-> 385, 1206\n442 <-> 274, 415, 442, 821\n443 <-> 1088, 1533\n444 <-> 666, 1260\n445 <-> 591, 1030, 1395, 1722\n446 <-> 203, 417, 1278, 1494, 1507\n447 <-> 447\n448 <-> 1599, 1882\n449 <-> 260, 1758\n450 <-> 17, 303, 1970\n451 <-> 188\n452 <-> 658, 763, 769\n453 <-> 212\n454 <-> 605\n455 <-> 478\n456 <-> 720, 1139, 1546\n457 <-> 598, 1127, 1496, 1518\n458 <-> 635\n459 <-> 1068\n460 <-> 1080, 1088, 1857\n461 <-> 739\n462 <-> 1344\n463 <-> 1775\n464 <-> 593, 1957\n465 <-> 703, 745, 1145\n466 <-> 1550, 1980\n467 <-> 467\n468 <-> 28\n469 <-> 1278\n470 <-> 470\n471 <-> 38, 996, 1626\n472 <-> 1933\n473 <-> 799\n474 <-> 86, 696, 1228\n475 <-> 491, 1250, 1739\n476 <-> 726\n477 <-> 1687\n478 <-> 455, 834, 835, 1389, 1983\n479 <-> 479\n480 <-> 237, 576\n481 <-> 791, 1370\n482 <-> 158, 1365\n483 <-> 761, 893\n484 <-> 1192\n485 <-> 1301\n486 <-> 1431\n487 <-> 165, 1119\n488 <-> 789\n489 <-> 235, 286\n490 <-> 490\n491 <-> 475, 1775\n492 <-> 1280, 1758\n493 <-> 1007, 1152\n494 <-> 1747\n495 <-> 495, 879\n496 <-> 1219\n497 <-> 643, 1118\n498 <-> 1010, 1529\n499 <-> 346, 353, 697, 1303\n500 <-> 81, 1700\n501 <-> 268\n502 <-> 502\n503 <-> 37, 416, 1121, 1740\n504 <-> 160, 909\n505 <-> 525, 1686, 1940\n506 <-> 1292, 1380\n507 <-> 342, 362, 969, 1674\n508 <-> 166, 1233\n509 <-> 1069\n510 <-> 636\n511 <-> 314, 1759\n512 <-> 1218, 1726\n513 <-> 1008, 1361, 1679\n514 <-> 1280\n515 <-> 1789\n516 <-> 619, 1835\n517 <-> 90, 1362, 1537\n518 <-> 880\n519 <-> 1329\n520 <-> 1248, 1441\n521 <-> 743, 1141, 1534, 1743\n522 <-> 333, 689\n523 <-> 1233\n524 <-> 860\n525 <-> 211, 505\n526 <-> 24, 984, 1503\n527 <-> 330, 344, 771, 1243\n528 <-> 898\n529 <-> 597\n530 <-> 1220, 1282\n531 <-> 2\n532 <-> 369, 821, 1806, 1937\n533 <-> 27, 1102\n534 <-> 1643, 1870\n535 <-> 569, 772\n536 <-> 536\n537 <-> 13\n538 <-> 1060, 1710\n539 <-> 65, 1002\n540 <-> 833, 1021, 1301\n541 <-> 1677\n542 <-> 542\n543 <-> 1242\n544 <-> 194, 698, 716, 1895\n545 <-> 1348, 1584\n546 <-> 797, 1622\n547 <-> 871, 1761\n548 <-> 1666\n549 <-> 1485\n550 <-> 1363, 1587\n551 <-> 25, 177, 645, 1311\n552 <-> 1208\n553 <-> 840\n554 <-> 4, 1454\n555 <-> 100, 170, 898, 1075, 1828, 1989\n556 <-> 924, 1614\n557 <-> 557\n558 <-> 432, 558\n559 <-> 1680\n560 <-> 1667\n561 <-> 760\n562 <-> 1668, 1799\n563 <-> 738\n564 <-> 1062, 1142, 1313\n565 <-> 750\n566 <-> 1104, 1614\n567 <-> 353, 744\n568 <-> 5, 568, 1338\n569 <-> 78, 535, 881\n570 <-> 600, 1516\n571 <-> 18, 1312, 1414, 1669\n572 <-> 572, 1958\n573 <-> 967, 1419\n574 <-> 209\n575 <-> 1013, 1087\n576 <-> 128, 480\n577 <-> 35, 577, 580\n578 <-> 36, 109\n579 <-> 1417\n580 <-> 577, 601, 700\n581 <-> 815, 1327, 1749\n582 <-> 891, 1263\n583 <-> 1652\n584 <-> 40, 338\n585 <-> 585\n586 <-> 640, 688, 1258, 1331\n587 <-> 1472\n588 <-> 298\n589 <-> 1170\n590 <-> 75, 1054\n591 <-> 41, 445\n592 <-> 47, 70\n593 <-> 188, 464, 1259, 1579\n594 <-> 268, 1194\n595 <-> 1, 1367, 1501\n596 <-> 45\n597 <-> 529, 626, 1237\n598 <-> 457, 648, 699\n599 <-> 1108, 1592\n600 <-> 570, 789, 1672\n601 <-> 580, 1298\n602 <-> 861, 1394\n603 <-> 1297, 1994\n604 <-> 1136\n605 <-> 454, 605\n606 <-> 832, 1109\n607 <-> 954, 1138\n608 <-> 287, 1971\n609 <-> 888\n610 <-> 55, 1580\n611 <-> 127, 710, 1087\n612 <-> 417, 950, 1428, 1464\n613 <-> 672, 1426\n614 <-> 794, 1724\n615 <-> 39, 848\n616 <-> 73, 103, 616\n617 <-> 726, 1026\n618 <-> 206, 1676\n619 <-> 516, 1204\n620 <-> 925\n621 <-> 338\n622 <-> 989\n623 <-> 153\n624 <-> 824, 1566, 1966\n625 <-> 272, 1326\n626 <-> 597, 750\n627 <-> 425\n628 <-> 1181, 1541, 1704\n629 <-> 1370, 1805\n630 <-> 630, 763\n631 <-> 1709\n632 <-> 1315, 1848\n633 <-> 1501\n634 <-> 674, 871\n635 <-> 458, 811\n636 <-> 377, 510, 1488\n637 <-> 1337\n638 <-> 781\n639 <-> 328, 1399\n640 <-> 177, 586, 1202, 1332, 1847\n641 <-> 261, 1942\n642 <-> 819\n643 <-> 497, 1089\n644 <-> 1661\n645 <-> 551\n646 <-> 312, 938, 1642, 1764\n647 <-> 1437\n648 <-> 598\n649 <-> 784, 1154, 1746\n650 <-> 1207, 1268\n651 <-> 1240, 1797\n652 <-> 1254\n653 <-> 10, 739, 764\n654 <-> 99, 1759\n655 <-> 895, 1784\n656 <-> 656, 701, 738\n657 <-> 1170\n658 <-> 452\n659 <-> 246\n660 <-> 809\n661 <-> 230, 414\n662 <-> 229\n663 <-> 1133, 1231\n664 <-> 745, 820\n665 <-> 128, 421\n666 <-> 242, 444, 926\n667 <-> 955, 1762\n668 <-> 1843\n669 <-> 1384, 1849\n670 <-> 211, 270, 1836\n671 <-> 1415\n672 <-> 63, 613, 1864\n673 <-> 964, 1973\n674 <-> 634, 1479, 1554\n675 <-> 1390\n676 <-> 1468, 1855\n677 <-> 1632\n678 <-> 201, 1445\n679 <-> 247, 422, 1401, 1484\n680 <-> 285\n681 <-> 269, 1115\n682 <-> 362, 682\n683 <-> 117, 1826\n684 <-> 977, 1458\n685 <-> 812\n686 <-> 1214, 1690, 1886\n687 <-> 1752\n688 <-> 586\n689 <-> 522\n690 <-> 1077, 1454\n691 <-> 62, 201, 815, 1019\n692 <-> 1454\n693 <-> 433, 941\n694 <-> 852\n695 <-> 695\n696 <-> 474\n697 <-> 499\n698 <-> 544\n699 <-> 598, 1448\n700 <-> 580\n701 <-> 656\n702 <-> 53, 238, 281\n703 <-> 92, 141, 228, 465, 1326\n704 <-> 8, 295, 1939\n705 <-> 196, 1099\n706 <-> 222, 275, 885, 905, 1531\n707 <-> 707, 1981\n708 <-> 185, 708, 1182, 1891, 1999\n709 <-> 1911\n710 <-> 611\n711 <-> 711, 1150\n712 <-> 1833\n713 <-> 713\n714 <-> 62, 1011, 1096, 1666\n715 <-> 1094\n716 <-> 544, 992\n717 <-> 1297\n718 <-> 718, 1727\n719 <-> 996\n720 <-> 456, 1388, 1748\n721 <-> 1331, 1458\n722 <-> 1535\n723 <-> 723\n724 <-> 305, 439\n725 <-> 317, 1854\n726 <-> 224, 476, 617, 1123\n727 <-> 35, 1249\n728 <-> 1369\n729 <-> 1537\n730 <-> 730, 1212\n731 <-> 389, 1815\n732 <-> 268\n733 <-> 1199\n734 <-> 919\n735 <-> 1627, 1694\n736 <-> 1036, 1319\n737 <-> 1345\n738 <-> 563, 656\n739 <-> 461, 653\n740 <-> 1069\n741 <-> 1436\n742 <-> 438, 1879, 1895\n743 <-> 521, 1657\n744 <-> 567\n745 <-> 465, 664\n746 <-> 873, 998\n747 <-> 254, 1380\n748 <-> 1089, 1329\n749 <-> 30, 86\n750 <-> 565, 626\n751 <-> 1362\n752 <-> 752\n753 <-> 840, 1066, 1424, 1745\n754 <-> 854, 1534, 1964\n755 <-> 1516, 1907\n756 <-> 41, 1069\n757 <-> 272\n758 <-> 1792\n759 <-> 1068\n760 <-> 561, 1048, 1377\n761 <-> 290, 413, 483, 1457\n762 <-> 1170\n763 <-> 452, 630\n764 <-> 653, 1521\n765 <-> 1928, 1986\n766 <-> 137, 434, 437\n767 <-> 1664\n768 <-> 924, 1562, 1923\n769 <-> 125, 452\n770 <-> 122, 851\n771 <-> 527, 1046, 1767\n772 <-> 535, 1056\n773 <-> 301, 1613, 1751\n774 <-> 903, 1110, 1318, 1849\n775 <-> 1640\n776 <-> 776\n777 <-> 777, 1593, 1880\n778 <-> 1194, 1524\n779 <-> 1299\n780 <-> 0\n781 <-> 638, 1434, 1448\n782 <-> 1540, 1554\n783 <-> 9\n784 <-> 649, 1017\n785 <-> 840, 915, 1325\n786 <-> 1424\n787 <-> 320, 1049\n788 <-> 1273\n789 <-> 488, 600\n790 <-> 924, 1085, 1775\n791 <-> 481\n792 <-> 1796\n793 <-> 232, 1860\n794 <-> 614, 1309\n795 <-> 347, 387\n796 <-> 796, 1059\n797 <-> 71, 225, 294, 418, 546\n798 <-> 150, 1818\n799 <-> 473, 1224\n800 <-> 1864\n801 <-> 123, 291, 1546\n802 <-> 802, 1648\n803 <-> 20, 803\n804 <-> 314\n805 <-> 1721\n806 <-> 1520\n807 <-> 1476\n808 <-> 155, 808\n809 <-> 660, 1880\n810 <-> 1816\n811 <-> 432, 635, 847\n812 <-> 131, 685, 1411\n813 <-> 1083\n814 <-> 1348\n815 <-> 581, 691\n816 <-> 223\n817 <-> 437, 1702\n818 <-> 205, 393, 1751\n819 <-> 642, 1161\n820 <-> 283, 664, 839, 1157\n821 <-> 442, 532, 1310, 1618, 1992\n822 <-> 1743\n823 <-> 1174\n824 <-> 624, 1051\n825 <-> 64, 1838\n826 <-> 194, 204, 1149\n827 <-> 244\n828 <-> 1791, 1930, 1936\n829 <-> 829, 1398\n830 <-> 1816\n831 <-> 329, 943, 1612\n832 <-> 606, 1223\n833 <-> 540, 833\n834 <-> 478\n835 <-> 478, 835, 1160\n836 <-> 906, 1558, 1905\n837 <-> 837, 1544\n838 <-> 883\n839 <-> 820\n840 <-> 553, 753, 785\n841 <-> 276\n842 <-> 1639\n843 <-> 843\n844 <-> 227, 1436\n845 <-> 845\n846 <-> 1266\n847 <-> 811, 1268, 1386, 1766\n848 <-> 615, 949\n849 <-> 1616\n850 <-> 1334, 1567, 1698\n851 <-> 770, 1807\n852 <-> 694, 1293, 1946\n853 <-> 967\n854 <-> 754\n855 <-> 1655\n856 <-> 959, 1706, 1733\n857 <-> 51\n858 <-> 866, 1949\n859 <-> 859\n860 <-> 244, 524, 999\n861 <-> 602, 1369, 1568\n862 <-> 129, 863, 1179\n863 <-> 862, 912, 1688, 1707, 1884\n864 <-> 916\n865 <-> 865, 1808\n866 <-> 356, 858\n867 <-> 1624\n868 <-> 244\n869 <-> 143, 916\n870 <-> 1030\n871 <-> 547, 634, 1638\n872 <-> 901, 1155, 1300\n873 <-> 161, 746, 1413\n874 <-> 874, 1985\n875 <-> 900, 1212, 1616\n876 <-> 876\n877 <-> 1197\n878 <-> 1732\n879 <-> 495, 1090\n880 <-> 173, 285, 518, 1400\n881 <-> 569, 1109\n882 <-> 234, 437, 1829\n883 <-> 838, 1416, 1492\n884 <-> 352, 1108\n885 <-> 190, 335, 706, 1802\n886 <-> 1930\n887 <-> 986\n888 <-> 42, 609, 1710\n889 <-> 412, 1242\n890 <-> 1116, 1335\n891 <-> 582\n892 <-> 1072, 1378, 1510\n893 <-> 214, 483, 1421\n894 <-> 1329\n895 <-> 655, 1480\n896 <-> 907\n897 <-> 897, 1191, 1753\n898 <-> 206, 528, 555, 1572, 1783\n899 <-> 1885\n900 <-> 875\n901 <-> 872, 1322\n902 <-> 28, 1490\n903 <-> 774, 1839\n904 <-> 904, 1392\n905 <-> 706, 1984\n906 <-> 110, 836, 1000, 1232\n907 <-> 94, 896, 907\n908 <-> 278, 1136\n909 <-> 504\n910 <-> 1938\n911 <-> 1507\n912 <-> 863, 1581, 1849\n913 <-> 1694\n914 <-> 348\n915 <-> 785\n916 <-> 864, 869, 1771\n917 <-> 89, 111\n918 <-> 1146, 1397\n919 <-> 734, 1647, 1936\n920 <-> 361, 1287\n921 <-> 977\n922 <-> 922\n923 <-> 1669\n924 <-> 556, 768, 790\n925 <-> 620, 1207, 1765\n926 <-> 666, 1801\n927 <-> 1083, 1151\n928 <-> 1265\n929 <-> 1082\n930 <-> 309, 1663\n931 <-> 193\n932 <-> 932, 1018\n933 <-> 991\n934 <-> 1554\n935 <-> 1826\n936 <-> 379, 988, 1011, 1871\n937 <-> 1585, 1694\n938 <-> 646, 1935\n939 <-> 102, 1355\n940 <-> 13, 146, 1337\n941 <-> 693, 1789\n942 <-> 1083, 1723\n943 <-> 831, 1471\n944 <-> 187, 432\n945 <-> 236\n946 <-> 387\n947 <-> 1579\n948 <-> 316, 1044, 1574\n949 <-> 848, 1914\n950 <-> 612\n951 <-> 1012, 1271\n952 <-> 43, 1535, 1574\n953 <-> 1986\n954 <-> 607, 1055, 1452\n955 <-> 667\n956 <-> 21, 1869\n957 <-> 957\n958 <-> 10\n959 <-> 135, 329, 856\n960 <-> 210, 1885\n961 <-> 1904\n962 <-> 415, 1658\n963 <-> 1156\n964 <-> 673\n965 <-> 52, 981\n966 <-> 429, 1734\n967 <-> 23, 573, 853\n968 <-> 1975\n969 <-> 507, 1865\n970 <-> 1870\n971 <-> 1175\n972 <-> 228\n973 <-> 1068\n974 <-> 1421\n975 <-> 975\n976 <-> 1401\n977 <-> 684, 921, 1798\n978 <-> 420\n979 <-> 1485\n980 <-> 1867, 1893\n981 <-> 283, 425, 965\n982 <-> 17, 1638\n983 <-> 1542\n984 <-> 526\n985 <-> 985\n986 <-> 429, 887\n987 <-> 221, 1784\n988 <-> 936\n989 <-> 622, 1114, 1154\n990 <-> 1023, 1027\n991 <-> 933, 991\n992 <-> 716\n993 <-> 73, 80\n994 <-> 1221, 1905\n995 <-> 175\n996 <-> 471, 719, 1379\n997 <-> 1790\n998 <-> 746\n999 <-> 860, 999, 1346\n1000 <-> 906\n1001 <-> 1171, 1649, 1850\n1002 <-> 98, 539, 1998\n1003 <-> 1244\n1004 <-> 1473\n1005 <-> 1706\n1006 <-> 1685\n1007 <-> 417, 493, 1845, 1980\n1008 <-> 239, 513, 1536\n1009 <-> 1202, 1442\n1010 <-> 60, 498, 1641\n1011 <-> 309, 714, 936, 1958\n1012 <-> 122, 951\n1013 <-> 575, 1239\n1014 <-> 1014, 1555, 1961\n1015 <-> 69, 308, 1559\n1016 <-> 64\n1017 <-> 784, 1586, 1643\n1018 <-> 932\n1019 <-> 691\n1020 <-> 1877\n1021 <-> 540, 1743, 1798\n1022 <-> 1900\n1023 <-> 990\n1024 <-> 1024\n1025 <-> 1444\n1026 <-> 88, 617\n1027 <-> 990, 1027, 1345\n1028 <-> 1228\n1029 <-> 44, 1264\n1030 <-> 445, 870, 1130\n1031 <-> 1158, 1610\n1032 <-> 1400\n1033 <-> 354\n1034 <-> 1802, 1849\n1035 <-> 1474\n1036 <-> 297, 736\n1037 <-> 1473, 1949\n1038 <-> 3, 126\n1039 <-> 1046\n1040 <-> 1082, 1100\n1041 <-> 1043\n1042 <-> 109\n1043 <-> 1041, 1520\n1044 <-> 948, 1977\n1045 <-> 266, 1189, 1972\n1046 <-> 771, 1039\n1047 <-> 161, 1168\n1048 <-> 229, 760\n1049 <-> 137, 787, 1738\n1050 <-> 374, 1925\n1051 <-> 824, 1631, 1989\n1052 <-> 174\n1053 <-> 266\n1054 <-> 590\n1055 <-> 65, 954, 1235\n1056 <-> 772, 1368\n1057 <-> 25, 1098\n1058 <-> 1792, 1819\n1059 <-> 796\n1060 <-> 127, 366, 419, 538\n1061 <-> 1665, 1887, 1983\n1062 <-> 564\n1063 <-> 408\n1064 <-> 436, 1073\n1065 <-> 347, 370\n1066 <-> 14, 753\n1067 <-> 1622\n1068 <-> 459, 759, 973, 1844\n1069 <-> 82, 509, 740, 756, 1099, 1259, 1351\n1070 <-> 1498\n1071 <-> 1935\n1072 <-> 892, 1072\n1073 <-> 1064, 1908\n1074 <-> 1609\n1075 <-> 555\n1076 <-> 1076\n1077 <-> 690\n1078 <-> 240, 1433\n1079 <-> 30, 223, 314, 1112\n1080 <-> 460\n1081 <-> 1574\n1082 <-> 9, 929, 1040, 1382\n1083 <-> 813, 927, 942\n1084 <-> 116, 202, 253, 1084, 1465\n1085 <-> 790\n1086 <-> 96, 1190\n1087 <-> 575, 611, 1412\n1088 <-> 443, 460\n1089 <-> 643, 748\n1090 <-> 879, 1208, 1288\n1091 <-> 1091, 1716\n1092 <-> 1456, 1606, 1925\n1093 <-> 1158, 1997\n1094 <-> 715, 1297, 1313, 1412, 1508\n1095 <-> 1095\n1096 <-> 714\n1097 <-> 58, 132, 1587\n1098 <-> 1057, 1254\n1099 <-> 705, 1069\n1100 <-> 1040, 1813\n1101 <-> 1101\n1102 <-> 533\n1103 <-> 75, 217, 241, 1188\n1104 <-> 566, 1792\n1105 <-> 1646\n1106 <-> 1107, 1574\n1107 <-> 1106\n1108 <-> 599, 884, 1144, 1476\n1109 <-> 606, 881\n1110 <-> 774\n1111 <-> 1475, 1560, 1663\n1112 <-> 1079\n1113 <-> 1113, 1715\n1114 <-> 989, 1910\n1115 <-> 183, 681, 1476, 1866\n1116 <-> 362, 890, 1271\n1117 <-> 370, 1757\n1118 <-> 497, 1977\n1119 <-> 487\n1120 <-> 1164\n1121 <-> 503\n1122 <-> 302, 1655\n1123 <-> 726, 1856\n1124 <-> 294\n1125 <-> 27, 1570\n1126 <-> 22\n1127 <-> 457, 1587\n1128 <-> 1320\n1129 <-> 1129, 1230\n1130 <-> 186, 1030, 1145, 1628\n1131 <-> 1151\n1132 <-> 321, 1902\n1133 <-> 277, 663, 1577\n1134 <-> 6, 290, 1976\n1135 <-> 219\n1136 <-> 604, 908\n1137 <-> 148, 1383\n1138 <-> 607\n1139 <-> 456, 1654\n1140 <-> 369\n1141 <-> 521\n1142 <-> 564, 1143\n1143 <-> 1142\n1144 <-> 1108\n1145 <-> 465, 1130, 1842\n1146 <-> 918\n1147 <-> 1282\n1148 <-> 1148\n1149 <-> 826\n1150 <-> 711\n1151 <-> 152, 927, 1131\n1152 <-> 493, 1720\n1153 <-> 1865\n1154 <-> 649, 989\n1155 <-> 872\n1156 <-> 963, 1668\n1157 <-> 820\n1158 <-> 1031, 1093, 1790\n1159 <-> 28, 438\n1160 <-> 835\n1161 <-> 819, 1789\n1162 <-> 26, 429, 1374\n1163 <-> 145\n1164 <-> 213, 337, 1120, 1366\n1165 <-> 1843\n1166 <-> 1884\n1167 <-> 1494, 1799\n1168 <-> 1047\n1169 <-> 316\n1170 <-> 589, 657, 762, 1685\n1171 <-> 1001\n1172 <-> 427, 1226\n1173 <-> 113, 1621\n1174 <-> 823, 1174\n1175 <-> 182, 971, 1405\n1176 <-> 1462\n1177 <-> 1177\n1178 <-> 1858, 1920\n1179 <-> 862, 1664\n1180 <-> 94\n1181 <-> 628, 1321\n1182 <-> 708\n1183 <-> 1693\n1184 <-> 1879\n1185 <-> 1674\n1186 <-> 1186, 1575\n1187 <-> 1341, 1718\n1188 <-> 1103\n1189 <-> 1045, 1433\n1190 <-> 1086\n1191 <-> 347, 402, 897\n1192 <-> 484, 1603, 1615\n1193 <-> 380, 1193\n1194 <-> 594, 778\n1195 <-> 67\n1196 <-> 1747\n1197 <-> 877, 1197\n1198 <-> 119, 267, 1380\n1199 <-> 222, 733\n1200 <-> 50, 415\n1201 <-> 406\n1202 <-> 640, 1009\n1203 <-> 37\n1204 <-> 287, 400, 619\n1205 <-> 1294\n1206 <-> 293, 441, 1444, 1899\n1207 <-> 650, 925\n1208 <-> 552, 1090\n1209 <-> 1797\n1210 <-> 168, 1264\n1211 <-> 1784\n1212 <-> 730, 875, 1515, 1636\n1213 <-> 1989\n1214 <-> 686, 1214\n1215 <-> 420\n1216 <-> 219, 408, 1651\n1217 <-> 292\n1218 <-> 354, 512\n1219 <-> 496, 1905\n1220 <-> 530\n1221 <-> 994\n1222 <-> 1222\n1223 <-> 250, 832\n1224 <-> 799, 1224\n1225 <-> 358, 1527\n1226 <-> 1172, 1619, 1721\n1227 <-> 1509\n1228 <-> 153, 167, 474, 1028\n1229 <-> 1538, 1959\n1230 <-> 1129\n1231 <-> 663\n1232 <-> 203, 906\n1233 <-> 508, 523, 1638\n1234 <-> 1693\n1235 <-> 1055\n1236 <-> 272\n1237 <-> 597, 1729\n1238 <-> 1656, 1933\n1239 <-> 1013\n1240 <-> 651\n1241 <-> 127, 1689, 1741\n1242 <-> 543, 889\n1243 <-> 527\n1244 <-> 393, 1003\n1245 <-> 1245\n1246 <-> 1733\n1247 <-> 1357, 1543\n1248 <-> 221, 520, 1810\n1249 <-> 727\n1250 <-> 475, 1372, 1444\n1251 <-> 1313\n1252 <-> 1364\n1253 <-> 1274\n1254 <-> 652, 1098\n1255 <-> 37, 273\n1256 <-> 169, 1671\n1257 <-> 1257\n1258 <-> 96, 586, 1474, 1513\n1259 <-> 593, 1069\n1260 <-> 398, 444, 1937\n1261 <-> 1684\n1262 <-> 1328, 1631\n1263 <-> 63, 582, 1284, 1637\n1264 <-> 266, 1029, 1210\n1265 <-> 928, 1376, 1629\n1266 <-> 103, 846\n1267 <-> 1733\n1268 <-> 650, 847, 1902\n1269 <-> 1269\n1270 <-> 1754\n1271 <-> 951, 1116, 1772\n1272 <-> 1453\n1273 <-> 126, 788\n1274 <-> 1253, 1420, 1503\n1275 <-> 228\n1276 <-> 105\n1277 <-> 1979\n1278 <-> 446, 469\n1279 <-> 1334\n1280 <-> 492, 514, 1405, 1941\n1281 <-> 1399\n1282 <-> 147, 530, 1147\n1283 <-> 270\n1284 <-> 1263\n1285 <-> 1976\n1286 <-> 86\n1287 <-> 66, 920\n1288 <-> 1090, 1588\n1289 <-> 79, 1619\n1290 <-> 65, 1368\n1291 <-> 112, 433\n1292 <-> 506\n1293 <-> 852\n1294 <-> 1205, 1813\n1295 <-> 4, 1542\n1296 <-> 1767\n1297 <-> 603, 717, 1094, 1340\n1298 <-> 601, 1387\n1299 <-> 242, 779, 1677\n1300 <-> 872\n1301 <-> 485, 540\n1302 <-> 258\n1303 <-> 499\n1304 <-> 1382, 1906\n1305 <-> 1305\n1306 <-> 173\n1307 <-> 1389, 1589\n1308 <-> 1308\n1309 <-> 77, 794, 1477\n1310 <-> 821, 1317\n1311 <-> 375, 551\n1312 <-> 571, 1843\n1313 <-> 564, 1094, 1251\n1314 <-> 1590\n1315 <-> 210, 632\n1316 <-> 59, 265, 1436, 1872\n1317 <-> 1310\n1318 <-> 774, 1511\n1319 <-> 141, 736\n1320 <-> 1128, 1799\n1321 <-> 1181, 1833\n1322 <-> 901, 1558\n1323 <-> 1846, 1906\n1324 <-> 1981\n1325 <-> 785\n1326 <-> 625, 703\n1327 <-> 581\n1328 <-> 1262\n1329 <-> 519, 748, 894\n1330 <-> 0, 105, 1851, 1979\n1331 <-> 586, 721\n1332 <-> 640\n1333 <-> 1544\n1334 <-> 263, 850, 1279\n1335 <-> 890\n1336 <-> 1336\n1337 <-> 637, 940\n1338 <-> 568\n1339 <-> 1383, 1449\n1340 <-> 1297\n1341 <-> 302, 1187, 1686, 1830\n1342 <-> 1553, 1658, 1725, 1822\n1343 <-> 1821\n1344 <-> 462, 1508\n1345 <-> 145, 737, 1027, 1947\n1346 <-> 236, 999\n1347 <-> 111\n1348 <-> 545, 814\n1349 <-> 1349, 1773, 1969\n1350 <-> 419\n1351 <-> 1069, 1384, 1946\n1352 <-> 1410\n1353 <-> 288, 1862, 1919\n1354 <-> 136, 195, 1739\n1355 <-> 939, 1366\n1356 <-> 1623\n1357 <-> 1247, 1650, 1949\n1358 <-> 231, 263\n1359 <-> 1422\n1360 <-> 1676\n1361 <-> 513, 1361, 1852\n1362 <-> 90, 368, 517, 751\n1363 <-> 550\n1364 <-> 344, 1252\n1365 <-> 482, 1968\n1366 <-> 1164, 1355\n1367 <-> 595\n1368 <-> 1056, 1290, 1634\n1369 <-> 728, 861, 1884\n1370 <-> 64, 481, 629\n1371 <-> 294, 1825\n1372 <-> 1250\n1373 <-> 1373, 1732\n1374 <-> 1162\n1375 <-> 1572, 1615\n1376 <-> 323, 1265\n1377 <-> 760\n1378 <-> 892\n1379 <-> 996\n1380 <-> 506, 747, 1198, 1545\n1381 <-> 5, 313\n1382 <-> 1082, 1304\n1383 <-> 1137, 1339\n1384 <-> 112, 669, 1351\n1385 <-> 421\n1386 <-> 847\n1387 <-> 1298, 1463\n1388 <-> 720\n1389 <-> 146, 478, 1307\n1390 <-> 675, 1390\n1391 <-> 1475, 1950\n1392 <-> 904\n1393 <-> 45, 72, 1815, 1954\n1394 <-> 602, 1594\n1395 <-> 106, 445, 1863, 1952\n1396 <-> 1495\n1397 <-> 918, 1925\n1398 <-> 829\n1399 <-> 331, 639, 1281\n1400 <-> 392, 880, 1032, 1422, 1673\n1401 <-> 679, 976\n1402 <-> 1830\n1403 <-> 133\n1404 <-> 219\n1405 <-> 1175, 1280\n1406 <-> 124, 274\n1407 <-> 1980\n1408 <-> 1624, 1717\n1409 <-> 1560\n1410 <-> 1352, 1410\n1411 <-> 14, 812, 1968\n1412 <-> 215, 1087, 1094\n1413 <-> 873, 1413\n1414 <-> 70, 571, 1701, 1943\n1415 <-> 421, 671\n1416 <-> 883, 1416\n1417 <-> 579, 1870\n1418 <-> 422, 1460\n1419 <-> 573\n1420 <-> 1274, 1864\n1421 <-> 176, 893, 974\n1422 <-> 1359, 1400\n1423 <-> 287\n1424 <-> 753, 786\n1425 <-> 1685\n1426 <-> 613, 1514\n1427 <-> 164\n1428 <-> 53, 612\n1429 <-> 359, 1556\n1430 <-> 298, 1927, 1955\n1431 <-> 22, 486\n1432 <-> 180\n1433 <-> 232, 1078, 1189, 1869\n1434 <-> 781\n1435 <-> 291, 1599\n1436 <-> 741, 844, 1316, 1577\n1437 <-> 647, 1722\n1438 <-> 1438\n1439 <-> 1, 257\n1440 <-> 2\n1441 <-> 343, 520\n1442 <-> 1009\n1443 <-> 1443, 1869\n1444 <-> 1025, 1206, 1250\n1445 <-> 678\n1446 <-> 246, 375\n1447 <-> 1981\n1448 <-> 325, 699, 781\n1449 <-> 57, 1339\n1450 <-> 1668\n1451 <-> 1692, 1802, 1911, 1951\n1452 <-> 954\n1453 <-> 167, 1272\n1454 <-> 117, 554, 690, 692\n1455 <-> 1581\n1456 <-> 1092, 1696\n1457 <-> 388, 761\n1458 <-> 684, 721\n1459 <-> 419, 1608\n1460 <-> 412, 1418, 1460\n1461 <-> 59\n1462 <-> 1176, 1571, 1979\n1463 <-> 1387, 1771\n1464 <-> 612\n1465 <-> 84, 1084\n1466 <-> 1553\n1467 <-> 248, 1709\n1468 <-> 676\n1469 <-> 1603\n1470 <-> 404, 1647\n1471 <-> 943, 1471\n1472 <-> 7, 351, 587, 1903\n1473 <-> 1004, 1037\n1474 <-> 1035, 1258\n1475 <-> 1111, 1391\n1476 <-> 807, 1108, 1115\n1477 <-> 1309\n1478 <-> 418\n1479 <-> 674\n1480 <-> 895, 1559\n1481 <-> 437\n1482 <-> 226\n1483 <-> 1510\n1484 <-> 679\n1485 <-> 549, 979, 1650\n1486 <-> 45, 1675, 1684\n1487 <-> 1632\n1488 <-> 636, 1590\n1489 <-> 243, 1489\n1490 <-> 902\n1491 <-> 190\n1492 <-> 883, 1661\n1493 <-> 1636\n1494 <-> 446, 1167\n1495 <-> 427, 1396\n1496 <-> 77, 457\n1497 <-> 1497\n1498 <-> 1070, 1498\n1499 <-> 1499\n1500 <-> 1781\n1501 <-> 595, 633\n1502 <-> 1502, 1782\n1503 <-> 526, 1274\n1504 <-> 60, 179\n1505 <-> 1646\n1506 <-> 1506\n1507 <-> 446, 911, 1978\n1508 <-> 1094, 1344, 1805\n1509 <-> 1227, 1979\n1510 <-> 892, 1483\n1511 <-> 1318\n1512 <-> 334, 360, 1642\n1513 <-> 251, 311, 1258\n1514 <-> 351, 1426\n1515 <-> 1212, 1580\n1516 <-> 296, 570, 755\n1517 <-> 1901\n1518 <-> 83, 439, 457\n1519 <-> 259\n1520 <-> 806, 1043, 1566\n1521 <-> 764\n1522 <-> 1912\n1523 <-> 431\n1524 <-> 778\n1525 <-> 54, 292, 1525\n1526 <-> 104, 1526\n1527 <-> 1225, 1527\n1528 <-> 15, 1683, 1794\n1529 <-> 498\n1530 <-> 62\n1531 <-> 270, 706\n1532 <-> 1942\n1533 <-> 443\n1534 <-> 521, 754\n1535 <-> 331, 722, 952, 1551\n1536 <-> 1008\n1537 <-> 517, 729, 1667\n1538 <-> 1229\n1539 <-> 273, 1582\n1540 <-> 324, 782\n1541 <-> 628\n1542 <-> 983, 1295, 1755\n1543 <-> 1247\n1544 <-> 837, 1333\n1545 <-> 1380, 1704\n1546 <-> 456, 801, 1717, 1993\n1547 <-> 1555\n1548 <-> 1745\n1549 <-> 1634\n1550 <-> 466, 1982\n1551 <-> 1535\n1552 <-> 212, 1594, 1613\n1553 <-> 276, 1342, 1466\n1554 <-> 674, 782, 934\n1555 <-> 341, 1014, 1547\n1556 <-> 1429\n1557 <-> 1787\n1558 <-> 836, 1322\n1559 <-> 1015, 1480\n1560 <-> 1111, 1409\n1561 <-> 1561\n1562 <-> 768\n1563 <-> 1563, 1567\n1564 <-> 1847\n1565 <-> 1743\n1566 <-> 624, 1520\n1567 <-> 110, 850, 1563\n1568 <-> 128, 861\n1569 <-> 1569\n1570 <-> 1125, 1769\n1571 <-> 1462\n1572 <-> 898, 1375\n1573 <-> 1846\n1574 <-> 948, 952, 1081, 1106, 1927\n1575 <-> 1186\n1576 <-> 114\n1577 <-> 1133, 1436\n1578 <-> 1821\n1579 <-> 593, 947\n1580 <-> 610, 1515\n1581 <-> 912, 1455\n1582 <-> 1539\n1583 <-> 49, 280, 363, 1779\n1584 <-> 545, 1902\n1585 <-> 937\n1586 <-> 408, 1017, 1605\n1587 <-> 550, 1097, 1127\n1588 <-> 1288\n1589 <-> 1307, 1823\n1590 <-> 1314, 1488\n1591 <-> 301\n1592 <-> 599\n1593 <-> 777\n1594 <-> 1394, 1552\n1595 <-> 1665\n1596 <-> 1909\n1597 <-> 214\n1598 <-> 1703\n1599 <-> 411, 448, 1435\n1600 <-> 1600\n1601 <-> 1822\n1602 <-> 1816\n1603 <-> 151, 1192, 1469, 1797, 1967\n1604 <-> 1688\n1605 <-> 1586\n1606 <-> 19, 401, 1092\n1607 <-> 130, 1770\n1608 <-> 1459, 1654\n1609 <-> 1074, 1728\n1610 <-> 1031\n1611 <-> 178, 1724\n1612 <-> 831\n1613 <-> 773, 1552\n1614 <-> 85, 556, 566\n1615 <-> 1192, 1375\n1616 <-> 849, 875, 1917\n1617 <-> 1791\n1618 <-> 821\n1619 <-> 1226, 1289\n1620 <-> 1620, 1832\n1621 <-> 1173\n1622 <-> 546, 1067, 1754\n1623 <-> 1356, 1652\n1624 <-> 170, 867, 1408, 1868\n1625 <-> 409, 1629\n1626 <-> 258, 471\n1627 <-> 77, 735\n1628 <-> 1130\n1629 <-> 1265, 1625\n1630 <-> 384, 1808\n1631 <-> 1051, 1262, 1784, 1833\n1632 <-> 677, 1487, 1709\n1633 <-> 69\n1634 <-> 1368, 1549\n1635 <-> 1635\n1636 <-> 1212, 1493\n1637 <-> 1263, 1990\n1638 <-> 871, 982, 1233\n1639 <-> 842, 1639\n1640 <-> 775, 1843\n1641 <-> 1010\n1642 <-> 646, 1512, 1816\n1643 <-> 534, 1017, 1929\n1644 <-> 130, 1820\n1645 <-> 1863\n1646 <-> 197, 1105, 1505, 1719\n1647 <-> 919, 1470, 1975\n1648 <-> 802\n1649 <-> 1001, 1676\n1650 <-> 1357, 1485, 1984\n1651 <-> 336, 1216, 1888\n1652 <-> 583, 1623, 1652\n1653 <-> 1745\n1654 <-> 1139, 1608\n1655 <-> 855, 1122\n1656 <-> 395, 1238\n1657 <-> 743, 1812\n1658 <-> 429, 962, 1342\n1659 <-> 1792\n1660 <-> 1764\n1661 <-> 644, 1492\n1662 <-> 33, 1726\n1663 <-> 930, 1111\n1664 <-> 767, 1179, 1913\n1665 <-> 357, 1061, 1595\n1666 <-> 32, 548, 714\n1667 <-> 560, 1537\n1668 <-> 562, 1156, 1450\n1669 <-> 571, 923\n1670 <-> 1674\n1671 <-> 1256\n1672 <-> 600\n1673 <-> 252, 1400, 1673, 1901\n1674 <-> 507, 1185, 1670\n1675 <-> 1486\n1676 <-> 618, 1360, 1649\n1677 <-> 61, 541, 1299\n1678 <-> 86, 249\n1679 <-> 513, 1700\n1680 <-> 559, 1920\n1681 <-> 199\n1682 <-> 1895\n1683 <-> 165, 1528, 1988\n1684 <-> 30, 1261, 1486\n1685 <-> 1006, 1170, 1425, 1980\n1686 <-> 505, 1341, 1720\n1687 <-> 477, 1977\n1688 <-> 863, 1604\n1689 <-> 1241\n1690 <-> 686\n1691 <-> 1785, 1890\n1692 <-> 1451\n1693 <-> 197, 1183, 1234\n1694 <-> 735, 913, 937\n1695 <-> 112\n1696 <-> 1456, 1921\n1697 <-> 174, 1768\n1698 <-> 850\n1699 <-> 1699\n1700 <-> 500, 1679\n1701 <-> 1414\n1702 <-> 817\n1703 <-> 56, 223, 1598\n1704 <-> 628, 1545\n1705 <-> 254\n1706 <-> 390, 856, 1005\n1707 <-> 863\n1708 <-> 1815\n1709 <-> 631, 1467, 1632\n1710 <-> 538, 888\n1711 <-> 1742\n1712 <-> 282\n1713 <-> 171\n1714 <-> 1714\n1715 <-> 1113\n1716 <-> 1091, 1729\n1717 <-> 1408, 1546\n1718 <-> 1187\n1719 <-> 1646, 1719, 1735\n1720 <-> 1152, 1686\n1721 <-> 805, 1226\n1722 <-> 180, 445, 1437\n1723 <-> 942\n1724 <-> 614, 1611\n1725 <-> 1342\n1726 <-> 156, 402, 512, 1662\n1727 <-> 718\n1728 <-> 1609, 1827, 1881\n1729 <-> 288, 1237, 1716\n1730 <-> 232\n1731 <-> 1863\n1732 <-> 88, 410, 878, 1373\n1733 <-> 856, 1246, 1267\n1734 <-> 966\n1735 <-> 1719\n1736 <-> 419\n1737 <-> 22, 363\n1738 <-> 93, 1049\n1739 <-> 475, 1354\n1740 <-> 427, 503\n1741 <-> 1241\n1742 <-> 1711, 1853\n1743 <-> 521, 822, 1021, 1565\n1744 <-> 1989\n1745 <-> 753, 1548, 1653\n1746 <-> 649\n1747 <-> 245, 494, 1196, 1810\n1748 <-> 172, 720\n1749 <-> 581\n1750 <-> 1768\n1751 <-> 192, 773, 818\n1752 <-> 215, 687\n1753 <-> 897\n1754 <-> 1270, 1622, 1945\n1755 <-> 1542\n1756 <-> 344\n1757 <-> 1117\n1758 <-> 449, 492\n1759 <-> 511, 654, 1938\n1760 <-> 209, 275\n1761 <-> 547\n1762 <-> 362, 667\n1763 <-> 35\n1764 <-> 276, 646, 1660\n1765 <-> 925\n1766 <-> 847, 1875\n1767 <-> 771, 1296\n1768 <-> 1697, 1750, 1768, 1780\n1769 <-> 1570, 1896\n1770 <-> 1607, 1770\n1771 <-> 279, 916, 1463\n1772 <-> 1271\n1773 <-> 1349, 1894\n1774 <-> 209\n1775 <-> 160, 463, 491, 790\n1776 <-> 282\n1777 <-> 1952\n1778 <-> 1952\n1779 <-> 1583\n1780 <-> 1768\n1781 <-> 1500, 1800\n1782 <-> 1502\n1783 <-> 381, 898\n1784 <-> 147, 435, 655, 987, 1211, 1631\n1785 <-> 1691, 1792\n1786 <-> 303\n1787 <-> 40, 68, 1557\n1788 <-> 1788\n1789 <-> 515, 941, 1161\n1790 <-> 397, 997, 1158\n1791 <-> 828, 1617\n1792 <-> 758, 1058, 1104, 1659, 1785\n1793 <-> 272\n1794 <-> 1528\n1795 <-> 9\n1796 <-> 792, 1933\n1797 <-> 651, 1209, 1603\n1798 <-> 977, 1021\n1799 <-> 562, 1167, 1320\n1800 <-> 216, 348, 1781\n1801 <-> 926, 1859\n1802 <-> 885, 1034, 1451\n1803 <-> 409\n1804 <-> 257\n1805 <-> 629, 1508\n1806 <-> 532\n1807 <-> 851\n1808 <-> 865, 1630\n1809 <-> 1809\n1810 <-> 1248, 1747\n1811 <-> 1911\n1812 <-> 1657\n1813 <-> 424, 1100, 1294\n1814 <-> 1906, 1937\n1815 <-> 731, 1393, 1708\n1816 <-> 810, 830, 1602, 1642\n1817 <-> 271, 1817\n1818 <-> 199, 798, 1818\n1819 <-> 1058\n1820 <-> 1644\n1821 <-> 68, 1343, 1578, 1904\n1822 <-> 1342, 1601\n1823 <-> 1589\n1824 <-> 60\n1825 <-> 1371\n1826 <-> 683, 935\n1827 <-> 93, 1728\n1828 <-> 326, 555\n1829 <-> 882\n1830 <-> 1341, 1402\n1831 <-> 1831\n1832 <-> 1620\n1833 <-> 712, 1321, 1631\n1834 <-> 1834\n1835 <-> 516\n1836 <-> 670\n1837 <-> 1837\n1838 <-> 825\n1839 <-> 903\n1840 <-> 1840\n1841 <-> 1841\n1842 <-> 1145\n1843 <-> 264, 332, 668, 1165, 1312, 1640\n1844 <-> 165, 241, 1068\n1845 <-> 1007\n1846 <-> 1323, 1573\n1847 <-> 640, 1564\n1848 <-> 632\n1849 <-> 669, 774, 912, 1034\n1850 <-> 1001, 1873\n1851 <-> 1330\n1852 <-> 1361\n1853 <-> 402, 1742\n1854 <-> 725\n1855 <-> 676, 1908\n1856 <-> 1123\n1857 <-> 418, 460\n1858 <-> 140, 271, 1178\n1859 <-> 1801\n1860 <-> 793\n1861 <-> 306, 340\n1862 <-> 1353\n1863 <-> 1395, 1645, 1731\n1864 <-> 672, 800, 1420\n1865 <-> 969, 1153\n1866 <-> 430, 1115\n1867 <-> 980\n1868 <-> 136, 1624\n1869 <-> 428, 956, 1433, 1443\n1870 <-> 534, 970, 1417\n1871 <-> 936\n1872 <-> 1316\n1873 <-> 1850\n1874 <-> 337\n1875 <-> 1766\n1876 <-> 1876\n1877 <-> 1020, 1877\n1878 <-> 365, 1878\n1879 <-> 742, 1184\n1880 <-> 777, 809\n1881 <-> 394, 1728\n1882 <-> 448\n1883 <-> 33\n1884 <-> 863, 1166, 1369\n1885 <-> 365, 899, 960\n1886 <-> 327, 686\n1887 <-> 46, 339, 1061\n1888 <-> 78, 1651\n1889 <-> 1889\n1890 <-> 1691\n1891 <-> 708\n1892 <-> 1892\n1893 <-> 980, 1941, 1947\n1894 <-> 1773\n1895 <-> 544, 742, 1682\n1896 <-> 285, 1769\n1897 <-> 378, 1993\n1898 <-> 1981\n1899 <-> 220, 1206\n1900 <-> 382, 390, 1022\n1901 <-> 1517, 1673\n1902 <-> 1132, 1268, 1584, 1959\n1903 <-> 1472\n1904 <-> 961, 1821\n1905 <-> 836, 994, 1219\n1906 <-> 1304, 1323, 1814\n1907 <-> 755\n1908 <-> 1073, 1855\n1909 <-> 31, 1596\n1910 <-> 1114, 1915\n1911 <-> 709, 1451, 1811\n1912 <-> 60, 1522\n1913 <-> 1664\n1914 <-> 24, 949\n1915 <-> 1910\n1916 <-> 222\n1917 <-> 1616\n1918 <-> 413\n1919 <-> 204, 268, 1353\n1920 <-> 1178, 1680\n1921 <-> 1696\n1922 <-> 26\n1923 <-> 768\n1924 <-> 405, 1924\n1925 <-> 79, 1050, 1092, 1397\n1926 <-> 1926\n1927 <-> 1430, 1574\n1928 <-> 376, 765\n1929 <-> 1643, 1947\n1930 <-> 828, 886\n1931 <-> 11, 1960\n1932 <-> 59, 136\n1933 <-> 472, 1238, 1796\n1934 <-> 431\n1935 <-> 938, 1071\n1936 <-> 828, 919\n1937 <-> 532, 1260, 1814\n1938 <-> 910, 1759\n1939 <-> 704\n1940 <-> 505\n1941 <-> 1280, 1893\n1942 <-> 248, 641, 1532\n1943 <-> 1414\n1944 <-> 325\n1945 <-> 1754\n1946 <-> 852, 1351\n1947 <-> 1345, 1893, 1929\n1948 <-> 35\n1949 <-> 121, 858, 1037, 1357\n1950 <-> 1391\n1951 <-> 1451\n1952 <-> 1395, 1777, 1778\n1953 <-> 1953\n1954 <-> 1393\n1955 <-> 1430\n1956 <-> 63, 118\n1957 <-> 464\n1958 <-> 572, 1011\n1959 <-> 1229, 1902\n1960 <-> 1931\n1961 <-> 1014\n1962 <-> 1962\n1963 <-> 380\n1964 <-> 754\n1965 <-> 300\n1966 <-> 624\n1967 <-> 1603\n1968 <-> 1365, 1411\n1969 <-> 1349\n1970 <-> 450\n1971 <-> 107, 608\n1972 <-> 1045\n1973 <-> 23, 389, 673\n1974 <-> 1974\n1975 <-> 361, 968, 1647, 1994\n1976 <-> 1134, 1285\n1977 <-> 7, 1044, 1118, 1687\n1978 <-> 1507\n1979 <-> 1277, 1330, 1462, 1509\n1980 <-> 466, 1007, 1407, 1685\n1981 <-> 707, 1324, 1447, 1898\n1982 <-> 348, 1550\n1983 <-> 478, 1061\n1984 <-> 905, 1650\n1985 <-> 874\n1986 <-> 765, 953\n1987 <-> 297\n1988 <-> 112, 1683\n1989 <-> 555, 1051, 1213, 1744\n1990 <-> 1637\n1991 <-> 1991\n1992 <-> 31, 133, 821\n1993 <-> 1546, 1897\n1994 <-> 603, 1975\n1995 <-> 325\n1996 <-> 1996\n1997 <-> 14, 1093\n1998 <-> 1002\n1999 <-> 708";

			var exampleGraph = ParseInput(example);
			var inputGraph = ParseInput(input);

			Debug.Assert(GetCompleteGroup(exampleGraph, "0").Count() == 6);
			Console.WriteLine(GetCompleteGroup(inputGraph, "0").Count());

			Debug.Assert(GroupCount(exampleGraph) == 2);
			Console.WriteLine(GroupCount(inputGraph));

			Console.WriteLine("Done");
			Console.ReadKey();
		}

		private static IEnumerable<string> GetCompleteGroup(Dictionary<string, HashSet<string>> graph, string input)
		{
			var workingQueue = new Queue<string>();
			var visited = new HashSet<string>();

			workingQueue.Enqueue(input);
			while (workingQueue.Count != 0)
			{
				var currentNode = workingQueue.Dequeue();
				yield return currentNode;
				visited.Add(currentNode);

				foreach (var neighbour in graph[currentNode])
				{
					if (!visited.Contains(neighbour) && !workingQueue.Contains(neighbour))
					{
						workingQueue.Enqueue(neighbour);
					}
				}
			}
		}

		private static int GroupCount(Dictionary<string, HashSet<string>> graph)
		{
			var edges = new HashSet<string>(graph.Keys);
			int groupCount = 0;

			while (edges.Count != 0)
			{
				var next = edges.First();
				edges.ExceptWith(GetCompleteGroup(graph, next));
				groupCount++;
			}

			return groupCount;
		}
		
		static Dictionary<string, HashSet<string>> ParseInput(string input)
		{
			var lines = NewLine.Split(input);
			var edges = lines.SelectMany(line =>
			{
				var split = Arrow.Split(line);
				var lhs = split[0].Trim();
				var rhsList = Seperator.Split(split[1]);
				return rhsList.Select(rhs => (lhs, rhs: rhs.Trim()));
			}).ToList();

			var graph = edges
				.Select(edge => edge.lhs)
				.Distinct()
				.ToDictionary(
					edge => edge,
					edge => new HashSet<string>());

			foreach (var (lhs, rhs) in edges)
			{
				graph[lhs].Add(rhs);
				graph[rhs].Add(lhs);
			}

			return graph;
		}

	}
}
